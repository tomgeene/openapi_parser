openapi: 3.0.3
info:
  title: Comprehensive API Test - OpenAPI 3.0
  version: 1.0.0
  description: Comprehensive test for OpenAPI 3.0 features
  contact:
    name: Support
    email: support@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.example.com/v1
    description: Production server
  - url: https://staging-api.example.com/v1
    description: Staging server

paths:
  /items:
    get:
      summary: List items
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: X-Request-ID
          in: header
          required: false
          schema:
            type: string
            format: uuid
        - $ref: "#/components/parameters/LimitParam"
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Item"
              examples:
                empty:
                  value: []
                withItems:
                  value:
                    - id: 1
                      name: Item 1
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      summary: Create item
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 255
                quantity:
                  type: integer
                  minimum: 0
      responses:
        "201":
          description: Created

  /items/{itemId}:
    parameters:
      - name: itemId
        in: path
        required: true
        schema:
          type: integer
    get:
      summary: Get item
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Item"

  /schema-tests/numbers:
    post:
      summary: Test number validations
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                integer:
                  type: integer
                integerRange:
                  type: integer
                  minimum: -100
                  maximum: 100
                exclusiveRange:
                  type: number
                  exclusiveMinimum: true
                  minimum: 0
                  exclusiveMaximum: true
                  maximum: 1
                multiple:
                  type: number
                  multipleOf: 0.5
      responses:
        "200":
          description: OK

  /schema-tests/strings:
    post:
      summary: Test string validations
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                basic:
                  type: string
                withLength:
                  type: string
                  minLength: 5
                  maxLength: 50
                pattern:
                  type: string
                  pattern: ^[A-Z][a-z]+$
                email:
                  type: string
                  format: email
                uri:
                  type: string
                  format: uri
                uuid:
                  type: string
                  format: uuid
                date:
                  type: string
                  format: date
                dateTime:
                  type: string
                  format: date-time
                password:
                  type: string
                  format: password
                  writeOnly: true
      responses:
        "200":
          description: OK

  /schema-tests/arrays:
    post:
      summary: Test array validations
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                basicArray:
                  type: array
                  items:
                    type: string
                boundedArray:
                  type: array
                  items:
                    type: number
                  minItems: 1
                  maxItems: 10
                uniqueArray:
                  type: array
                  items:
                    type: integer
                  uniqueItems: true
                tupleArray:
                  type: array
                  items:
                    oneOf:
                      - type: string
                      - type: number
      responses:
        "200":
          description: OK

  /schema-tests/objects:
    post:
      summary: Test object validations
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - requiredField
              properties:
                requiredField:
                  type: string
                optionalField:
                  type: string
                nestedObject:
                  type: object
                  properties:
                    nested:
                      type: string
                dynamicProps:
                  type: object
                  additionalProperties:
                    type: integer
                noAdditional:
                  type: object
                  additionalProperties: false
                boundedProps:
                  type: object
                  minProperties: 1
                  maxProperties: 5
      responses:
        "200":
          description: OK

  /schema-tests/composition:
    post:
      summary: Test schema composition
      requestBody:
        content:
          application/json:
            schema:
              allOf:
                - type: object
                  properties:
                    id:
                      type: integer
                - type: object
                  properties:
                    name:
                      type: string
      responses:
        "200":
          description: OK

  /schema-tests/polymorphism:
    post:
      summary: Test polymorphism
      requestBody:
        content:
          application/json:
            schema:
              oneOf:
                - $ref: "#/components/schemas/Circle"
                - $ref: "#/components/schemas/Square"
              discriminator:
                propertyName: shapeType
      responses:
        "200":
          description: OK

components:
  schemas:
    Item:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: integer
          readOnly: true
        name:
          type: string
        description:
          type: string
          nullable: true
        tags:
          type: array
          items:
            type: string

    Error:
      type: object
      required:
        - message
      properties:
        message:
          type: string
        code:
          type: integer

    Circle:
      type: object
      required:
        - shapeType
        - radius
      properties:
        shapeType:
          type: string
          enum: [circle]
        radius:
          type: number
          minimum: 0

    Square:
      type: object
      required:
        - shapeType
        - side
      properties:
        shapeType:
          type: string
          enum: [square]
        side:
          type: number
          minimum: 0

  parameters:
    LimitParam:
      name: limit
      in: query
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20

  responses:
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic
    ApiKey:
      type: apiKey
      in: header
      name: X-API-KEY

security:
  - BasicAuth: []
  - ApiKey: []

